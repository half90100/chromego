/*! 2014-12-19 11:12:26 */
KISSY.add("haitaoAddressDialog",function(a,b,c,d,e,f,g,h,i,j){function k(a,b){var c=this;k.superclass.constructor.apply(c),c.set("html",a),c.set("addrList",b),c.init()}return a.extend(k,b,{init:function(){var a=this,b=a.get("className");return KISSY.one("."+b)?null:(a._initDialog(),a._initAddrSelect(),void a._bindEvents())},_bindEvents:function(){var a=this,b=a.get("copyTip");KISSY.Event.delegate(document,"click",".haitao_font .haitao_copy_btn",function(b){try{var c=KISSY.one(b.target),d=c.parent("tr").children(".haitao_transaddr_right").text();a.copyToClipBoard(d,c)}catch(b){a.copyToClipBoard("")}},a),b=new e({elCls:"haitao_font haitao_hover_tip",width:80,height:20}),a.set("copyTip",b),KISSY.all(".haitao_copy_btn").each(function(b){var c=a.get("copyTip");b.on("mouseenter",function(){a.removeCopySuccess(),c.set("content","点击复制地址"),c.set("align",{node:b,points:["cr","cl"],offset:[10,0]}),c.show()},a),b.on("mouseleave",function(){c.hide()})})},_initDialog:function(){var a=this,b=a.get("html"),c=a.get("className"),d=a.get("dialogConfig"),f={width:430,elCls:"haitao_dialog haitao_font "+c,mask:!1,headerContent:"转运地址填写",bodyContent:b};f=KISSY.merge(d,f);var g=new e.Dialog(f);g.show(),g.on("hide",function(){g.destroy()})},_initAddrSelect:function(){var a=this,b=a.get("addrList"),c=a.get("tipsMap");new haitaoAddrSelect(b,function(a){var b=KISSY.one(".haitao_dialog_address .haitao_addr_youhui"),d=KISSY.one(".haitao_dialog_address .haitao_transaddr_info"),e=c[a.transId];e&&(""!=e.youhui?(b.html("<i></i>"+e.youhui),d.html("")):(b.html(""),d.html('<a target="_blank" href="'+e.url+'">查看价格详情<i></i></a>'))),KISSY.all(".haitao_transaddr_hide").show(),KISSY.one(".haitao_transaddr_fname .haitao_transaddr_right").html(a.firstName),KISSY.one(".haitao_transaddr_lname .haitao_transaddr_right").html(a.lastName),KISSY.one(".haitao_transaddr_fullname .haitao_transaddr_right").html((a.firstName+" "+a.lastName).trim()),KISSY.one(".haitao_transaddr_address1 .haitao_transaddr_right").html(a.address1),KISSY.one(".haitao_transaddr_address2 .haitao_transaddr_right").html(a.address2),KISSY.one(".haitao_transaddr_city .haitao_transaddr_right").html(a.city),KISSY.one(".haitao_transaddr_province .haitao_transaddr_right").html(a.province),KISSY.one(".haitao_transaddr_zipcode .haitao_transaddr_right").html(a.zipCode),KISSY.one(".haitao_transaddr_country .haitao_transaddr_right").html(a.state),KISSY.one(".haitao_transaddr_tel .haitao_transaddr_right").html(a.telephone)},"_dialog")},removeCopySuccess:function(){var a="haitao_copy_success",b=KISSY.one("#"+a);b&&b.remove()},showCopySuccess:function(a){var b=this,c=b.get("copyTip"),d=b.get("timeout");c&&c.hide(),d&&clearTimeout(d);var e="haitao_copy_success";b.removeCopySuccess();var f=j.getAbsolutePos(a,22,-8),g={triangle:"left",left:f.left,top:f.top,posAlign:"left",id:e,style:"",text:"",textHtml:"",aftertext:"复制成功啦！"},i=h.to_html(window.Ali_Haitao.template.otherTips,g);KISSY.one("body").append(i),d=setTimeout(function(){b.removeCopySuccess()},1e3),b.set("timeout",d)},copyToClipBoard:function(a,b){var c=this;return"www.haiwen.com"==location.host?void c.showCopySuccess(b):void j.getMessageFromBackground({operate:"clipboardWrite",data:a},function(){c.showCopySuccess(b)})}},{ATTRS:{copyTip:{value:null},timeout:{value:null},className:{value:"haitao_dialog_address"},dialogConfig:{value:{draggable:!0,elCls:"haitao_dialog haitao_font ",prefixCls:"haitao-ks-",headerContent:"提示",bodyContent:'<div class="haitao_empty_div"></div>',mask:!1,closeAction:"destroy",align:{overflow:{adjustX:1,adjustY:1},offset:[0,100],points:["tc","cc"]},aria:!0}},tipsMap:{value:{2088502839319682:{id:"2088502839319682",name:"友家",url:"http://www.youjiaus.net/Help/202/203/201212140435572487.html",youhui:"首$7.5+续$3.5"},2088011252032565:{id:"2088011252032565",name:"友家",url:"http://www.youjiaus.net/Help/202/203/201212140435572487.html",youhui:"首$7.5+续$3.5"},2088502928803315:{id:"2088502928803315",name:"递四方",url:"http://tr.4px.com/price.html?",youhui:"首$8+续$4"},2088301345047652:{id:"2088301345047652",name:"斑马",url:"http://www.360zebra.com/Price/pricelist.aspx",youhui:""},2088801938531620:{id:"2088801938531620",name:"百通",url:"http://buytong.com/PriceQuery.aspx",youhui:""}}}}}),k},{requires:["base","node","event","overlay","gallery/slide/1.2/index","dd","mu","haitaoAddrSelect","haitaoUtils"]});