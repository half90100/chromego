/*! 2014-12-19 11:12:26 */
KISSY.add("haitaoAddressEditDialog",function(a,b,c,d,e,f,g){function h(a,b,c){var d=this;h.superclass.constructor.apply(d),d.set("html",a),d.set("addrList",b),d.set("selectedID",c),d.init()}return a.extend(h,b,{init:function(){var b=this,c=b.get("className");a.one("."+c)||(b._formateData(),b._initDialog(),b._initDom(),b._bindEvents())},_bindEvents:function(){var b=this,c=b.get("dialog"),d=b.get("className"),e=b.get("templateData");a.one("."+d).delegate("click",".haitao_transaddr_usercodewrap .submit",function(b){b.preventDefault();var f=a.one("."+d).one(".haitao_transaddr_usercodewrap"),g={fn:f.one("#fn").val(),ln:f.one("#ln").val(),ap:f.one("#ap").val(),comp_id:e.id,_tb_token_:window.Ali_Haitao.login._tb_token_||""},h=RUNTIME_MODE===RUNTIME_MODE_DEV?"./data.json":"http://haiwai.etao.com/ajax/transfer_user_info_inter.htm";KISSY.io.get(h,g,function(a){a&&0==a.resultCode,c.hide()},"json")})},destroy:function(){var b,c=this,d=c.get("dialog"),e=c.get("className");b=a.one("."+e),b&&b.undelegate("click",".haitao_transaddr_usercodewrap .submit"),d.destroy()},_initDialog:function(){var a=this,b=a.get("html"),c=a.get("className"),d=a.get("dialogConfig"),e=a.get("templateData"),h={width:430,elCls:"haitao_dialog haitao_font "+c,mask:!1,headerContent:"设置转运地址",bodyContent:g.to_html(b,e)};h=KISSY.merge(d,h),dialog=new f.Dialog(h),dialog.show(),dialog.on("hide",function(){dialog.destroy()}),a.set("dialog",dialog)},_initDom:function(){var b=this,c=b.get("className"),d=b.get("templateData"),e=a.one("."+c);if(e){var f=e.one(".haitao_transaddr_usercodewrap"),g=d;f.one("#fn").val(g.fn),f.one("#ln").val(g.ln),"友家速递"==g.name||"海淘客"==g.name||"递四方"==g.name?(f.one("#ap").val(""),f.one("#ap").parent(".haitao_transaddr_formcontrol").hide()):(f.one("#ap").val(g.ap),f.one("#ap").parent(".haitao_transaddr_formcontrol").show()),f.show(),f.one("#fn").getDOMNode().focus()}},_formateData:function(){var b=this,c=b.get("addrList"),d=b.get("selectedID"),e=b.get("templateData");e=null,a.each(c,function(a){a.id===d&&(e={id:a.id,name:a.name,fn:a.list[0].firstName,ln:a.list[0].lastName,ap:a.list[0].address2})}),e.isEdit=!0,b.set("templateData",e)}},{ATTRS:{dialog:{value:null},dialogConfig:{value:{draggable:!0,elCls:"haitao_dialog haitao_font ",prefixCls:"haitao-ks-",headerContent:"提示",bodyContent:'<div class="haitao_empty_div"></div>',mask:!1,closeAction:"destroy",align:{overflow:{adjustX:1,adjustY:1},offset:[0,300],points:["tc","cc"]},aria:!0}},className:{value:"haitao_dialog_address"},templateData:{value:null}}}),h},{requires:["base","node","event","io","overlay","mu","menubutton","haitaoUtils"]});