/*! 2014-12-19 11:12:26 */
KISSY.add("haitaoSearchTrans",function(a,b,c,d,e,f){function g(b,c,d,e){a.one(b)&&(this.inputQuery=b,this.inputObj=a.one(b),this.posAdjustX=c,this.posAdjustY=d,this.callback=e,this.init())}return a.extend(g,b,{inputQuery:"",inputObj:null,posAdjustX:0,posAdjustY:0,callback:null,init:function(){this._bindEvents()},_bindEvents:function(){var b=this;KISSY.Event.delegate(document,"keyup",b.inputQuery,function(c){if(13==c.keyCode){var d=a.one("#haitao_input_trans .haitao_trans_item");d&&d.attr("transtext")&&""!=d.attr("transtext")&&(b.inputObj.val(d.attr("transtext")),b.callback(d.attr("transtext")))}else b.handleInputText()}),KISSY.Event.delegate(document,"focus",b.inputQuery,function(){b.handleInputText()}),KISSY.Event.delegate(document,"click","#haitao_input_trans .haitao_trans_item",function(c){var d=a.one(c.target);d.hasClass("haitao_trans_item")||(d=d.parent(".haitao_trans_item")),b.inputObj.val(d.attr("transtext")),b.removeTransTip(),b.callback(d.attr("transtext"))}),KISSY.Event.delegate(document,"click","body",function(a){b.inputObj[0]!=a.target&&b.removeTransTip()}),KISSY.one("body").on("haitaoTranslateInputCallback",function(){b.callTranslateCallback()})},handleInputText:function(){var b=this,c=a.trim(b.inputObj.val()),d=/[\u4e00-\u9fa5]/gi,e=c.match(d);e&&e.length>0?b.callTranslate(c):b.removeTransTip()},removeTransTip:function(){var b=a.one("#haitao_input_trans");b&&b.remove&&b.remove()},callTranslateCallback:function(){var a=this;a.removeTransTip();var b=window.Ali_Haitao.translateInputData;if(b&&b.desc&&0!=b.desc.length&&!b.isError){var c=HaitaoUtils.getAbsolutePos(a.inputObj,a.posAdjustX,a.posAdjustY);b.top=c.bottom,b.left=c.left;var d=f.to_html(window.Ali_Haitao.template.inputtrans,b);KISSY.one("body").append(d)}},callTranslate:function(a){"www.haiwen.com"==location.host?callTranslateAjax():HaitaoUtils.getMessageFromBackground({operate:"translateInput",data:a},function(){})}}),g},{requires:["base","node","event","menubutton","mu"]});