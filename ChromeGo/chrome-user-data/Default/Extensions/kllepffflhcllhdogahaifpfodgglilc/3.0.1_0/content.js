/*! 2014-12-19 11:12:26 */
function dealWebsite(){console.time("dealWebsite"),window.Ali_Haitao.isLoadTips="true";var a=window.Ali_Haitao.config;if(a&&a.website){var b=getMatchedWebSiteDomain();if("null"==b)return;var c=a.website[b];if(c&&c.tips){var d=b+"Function";KISSY.use(d,function(a,d){function e(){if("true"==window.Ali_Haitao.isShowTips){h&&clearTimeout(h),sessionStorage.startTime?sessionStorage.startTime++:sessionStorage.startTime=1,window.onbeforeunload=function(){sessionStorage.startTime=0},console.log("globeRePosTips startTime: "+sessionStorage.startTime);var a=window.Ali_Haitao.config;if(a&&a.website){var c=a.website[b];c&&c.tips&&(HaitaoUtils.initTips(c.tips),g.reposTips&&(console.log("globeRePosTips end"),g.reposTips(),console.timeEnd("dealWebsite")))}h=null}}function f(a){clearTimeout(i),i=setTimeout(function(){var b=a&&a.target;if(!b||!b.tagName||"body"!=b.tagName.toLowerCase()){var c=KISSY.DOM.parent,d=c(b,"body"),e=KISSY.one(b);!d||c(b,".haitao_font")||c(b,".haitao-button")||c(b,".haitao-menu")||c(b,".etaologin-overlay")||c(b,".FSO-cycle")||e.hasClass("haitao_font")||e.hasClass("haitao-button")||e.hasClass("haitao-menu")||e.hasClass("etaologin-overlay")||e.hasClass("FSO-cycle")||KISSY.one("body").fire("haitaoRepaint")}},50)}var g=new d;window.Ali_Haitao.curWebSite=g,g.init(),HaitaoUtils.initTips(c.tips);var h=null;HaitaoUtils.getCurrentRate(),HaitaoUtils.getShipAddress(),KISSY.one("body").detach("haitaoRepaint",e),KISSY.one("body").on("haitaoRepaint",e);var i=null,j=KISSY.one(document);j.detach("DOMSubtreeModified",f),j.on("DOMSubtreeModified",f)})}else HaitaoUtils.getCurrentRate(),HaitaoUtils.getShipAddress()}}function isMatchedWebSite(){var a=window.location.hostname;if(a=a.replace(/^www\./,""),"gnc.com.cn"==a)return!1;for(var b=0;b<allowWebSite.length;b++)if(a==allowWebSite[b])return!0;return!1}function getMatchedWebSiteDomain(){for(var a=window.location.host,b=0;b<allowWebSite.length;b++)if(-1!=a.indexOf(allowWebSite[b]))return allowWebSite[b].replace(".com","").replace("6pm","sixpm").replace("us-dc2-order.store.yahoo.net","albeebaby").replace("order.store.yahoo.net","albeebaby");return"null"}function AliPVStatistics(){KISSY.Stat("cache=4504651&gmkey=etao_search&gokey=sfrom=etao&t=1369193914137&syn_show=haitao_page:{{browser}}&cna="+(window.Ali_Haitao.mmstat_cna?window.Ali_Haitao.mmstat_cna:"null")+"&isbeta=7&logtype=2",!0)}function AliStatistics(){var a=KISSY,b=a.DOM,c=(a.Event,a.all);c("body").delegate("click",".haitao-stat[data-stat]",function(c){var d="cache=16f63b4&gmkey=etao_search&gokey=sfrom=etao&t=1369194202558&&cna="+(window.Ali_Haitao.mmstat_cna?window.Ali_Haitao.mmstat_cna:"null")+"&isbeta=7&logtype=2&click=etao.etao_haitao_addin.{{browser}}.",e=c.target,f=a.one(e);if(f.hasClass("haitao-stat")||(e=b.parent(e,".haitao-stat"))){var g=b.attr(e,"data-stat");g&&a.Stat&&a.Stat(d+g,!0)}})}console.time("startrun");var RUNTIME_MODE_DEV=0,RUNTIME_MODE_PROD=1;RUNTIME_MODE=RUNTIME_MODE_PROD,KISSY.use("haitaoUtils",function(a,b){chrome.extension.onMessage.addListener(function(a){"translateCallback"==a.operate?b.translateCallback(a.data):"translateInputCallback"==a.operate?(window.Ali_Haitao.translateInputData=a.data,KISSY.one("body").fire("haitaoTranslateInputCallback")):"loginStatusChanged"==a.operate?JSON.stringify(window.Ali_Haitao.login)!=JSON.stringify(a.data)&&(window.Ali_Haitao.login=a.data,b.getShipAddress(),KISSY.one("body").fire("haitaoRepaint"),KISSY.one("body").fire("loginStatusChanged")):"getShipAddressCallback"==a.operate?(window.Ali_Haitao.shipAddress=a.data,KISSY.one("body").fire("getShipAddressCallback")):"needLogin"==a.operate?b.popupLogin():"neverRemindAddrNotify"==a.operate&&b.neverRemindAddrNotify()})}),KISSY.use("node, stat, hoverGetWord, haitaoUtils, haitaoSidebar, haitaoShopIntroTip",function(a,b,c,d,e,f,g){function h(){}AliStatistics(),AliPVStatistics(),console.timeEnd("startrun"),(window.Ali_Haitao.debug||isMatchedWebSite())&&(e.getMessageFromBackground({operate:"getConfig",data:""},function(a){if(function(){localStorage.start?localStorage.start++:localStorage.start=0,console.log("start: "+localStorage.start),window.onbeforeunload=function(){localStorage.start=0}}(),window.Ali_Haitao.isLoadRemoteRes=JSON.parse(a.isLoadRemoteRes),window.Ali_Haitao.config=JSON.parse(a.config),window.Ali_Haitao.mmstat_cna=a.mmstat_cna,window.Ali_Haitao.template=KISSY.merge(window.Ali_Haitao.template,a.template),window.Ali_Haitao.isTranslate=a.isTranslate,window.Ali_Haitao.isShowTips=a.isShowTips,window.Ali_Haitao.isShowPushNotify=a.isShowPushNotify,window.Ali_Haitao.transTimeStat=a.transTimeStat,window.Ali_Haitao.login=JSON.parse(a.login),window.Ali_Haitao.config&&e.checkWebSite()){new d({duration:1e3}),h();var b=getMatchedWebSiteDomain();if("null"!=b&&window.Ali_Haitao.template&&window.Ali_Haitao.template.sidebar){var c=JSON.parse(window.Ali_Haitao.template.shopInfo)[b]||{};c.isTranslate="false"==window.Ali_Haitao.isTranslate?!1:!0,c.isShowTips="false"==window.Ali_Haitao.isShowTips?!1:!0,c.isShowPushNotify="false"==window.Ali_Haitao.isShowPushNotify?!1:!0,e.generateTemplateHtml(window.Ali_Haitao.template.sidebar,c,function(a){new f({template:a})}),c.isShow&&e.generateTemplateHtml(window.Ali_Haitao.template.shopInfoTip,c,function(a){new g(a)})}e.loadExtraResource(),e.showBrowserAddrNotify(),"true"==window.Ali_Haitao.isShowTips&&dealWebsite()}}),"gnc.com"==location.host&&KISSY.one("body").delegate("click","#monetate_lightbox_0 a",function(){KISSY.one("#haitao_others_tips_4")&&KISSY.one("#haitao_others_tips_4").remove()}))});