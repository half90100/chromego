/*! 2014-12-19 11:12:26 */
function getTemplate(){var a={},b=JSON.parse(localStorage.haitao_config||null);if(b&&b.template)for(var c in b.template)a[c]=localStorage["haitao_temp_"+c];return a}function getAccountId(){var a=JSON.parse(localStorage.haitao_login||null);return a&&"true"==a.login&&""!=a.unb?a.unb:(window.haitaoLogin.login(),null)}function checkIsLogin(){var a=JSON.parse(localStorage.haitao_login||null);return a&&"true"==a.login?!0:!1}function autoFitHeight(){return}function initEvent(){KISSY.one("#haitao_login .logout").on("click",function(){window.haitaoLogin.logout()}),KISSY.one("#haitao_login .haitao_notLogin").on("click",function(){window.haitaoLogin.login()}),KISSY.one("#haitao_login .haitao_close").on("click",function(){window.close()}),KISSY.one("body").on("loginStatusUpdate",function(){var a=JSON.parse(localStorage.haitao_login||null);a&&"true"==a.login?(KISSY.one("#haitao_login").addClass("haitao_islogin"),KISSY.one("#haitao_login .login_name").html(decodeURIComponent(a.a_nk||a._nk_)),getAlipayIdAjax(),setTimeout(function(){KISSY.one(".J_CloseLoginBtn")?KISSY.one(".J_CloseLoginBtn").fire("click"):""},500)):(htmlWhenLogout(),haitao_tools.setPopupBadgeText(0))})}function htmlWhenLogout(){KISSY.one("#haitao_login .login_name").html(""),KISSY.one("#haitao_login").removeClass("haitao_islogin"),KISSY.one("#haitao_pop_tab").fire("logout")}function setTransMap(a){for(var b={youjia:"友家速递",banma:"斑马物流",disifang:"递四方",baitong:"百通"},c={},d=a.data,e=0;e<d.length;e++){var f=d[e];for(var g in b)if(b[g]==f.name){c[g]=f.id;break}}localStorage.haitao_map_transComp=JSON.stringify(c)}function getAlipayIdAjax(){function a(a){var b="object"==typeof a?a:JSON.parse(a);0==b.resultCode?(localStorage["login_alipay_id_"+getAccountId()]=b.aid,setTransMap(b),KISSY.one(".haitao_shipList").fire("trackChange")):"获得用户支付宝信息错误"==b.msg&&console.log("getAlipayIdAjax 获得用户登录信息错误， 重复登陆")}return getAlipayTimeout?void clearTimeout(getAlipayTimeout):void(getAlipayTimeout=setTimeout(function(){if(getAccountId()){var b="http://haiwai.etao.com/ajax/tranship_addr.htm";KISSY.io.get(b,function(b){a(b)})}getAlipayTimeout=null},100))}function AliStatistics(){var a=KISSY,b=a.DOM,c=(a.Event,a.all),d="cache=16f63b4&gmkey=etao_search&gokey=sfrom=etao&t=1369194202558&&cna="+(window.Ali_Haitao.mmstat_cna?window.Ali_Haitao.mmstat_cna:"null")+"&isbeta=7&logtype=2&click=etao.etao_haitao_addin.{{browser}}.";c("body").delegate("click",".haitao-stat[data-stat]",function(c){var e=c.target,f=a.one(e);if(f.hasClass("haitao-stat")||(e=b.parent(e,".haitao-stat"))){var g=b.attr(e,"data-stat");g&&a.Stat&&a.Stat(d+g,!0)}})}function popup_init(){loadExtraResource(),initEvent(),checkIsLogin()&&getAlipayIdAjax(),window.haitaoLogin.init(),KISSY.use("haitaoPopup",function(a,b){new b}),KISSY.use("haitaoFeed",function(a,b){new b}),KISSY.use("haitaoZhuanXiang",function(a,b){new b({el:a.one("#shenqi_zhuanxiang"),tab:a.one("#haitao_pop_tab").one(".zhuanxiang")})})}function loadExtraResource(){return}var haitaoRuntime="popup";KISSY.add("haitaoTrackAjax",function(a){function b(){}return a.augment(b,{trackListObj:{trackList:[]},resetTrackList:function(){return{trackList:[]}},getTrackList:function(){var a=this;if(localStorage.haitao_trackList)if(haitaoRuntime&&"background"==haitaoRuntime){a.trackListObj=a.resetTrackList();var b=JSON.parse(localStorage.haitao_trackList);if(b)for(var c in b)a.trackListObj.trackList=a.trackListObj.trackList.concat(b[c].trackList)}else{if(a.trackListObj&&a.trackListObj.trackList&&a.trackListObj.trackList.lenth>0)return a.trackListObj;a.trackListObj=a.resetTrackList();var d=a.getAccountId();if(null!=d){var b=JSON.parse(localStorage.haitao_trackList||"{}");b&&b[d]&&(a.trackListObj=b[d])}}return a.setBadgeText(),a.trackListObj},setTrackListTimeout:null,setTrackList:function(){var a=this;haitaoRuntime&&"background"==haitaoRuntime?(a.setTrackListTimeout&&clearTimeout(a.setTrackListTimeout),a.setTrackListTimeout=setTimeout(function(){a.setTrackListTimeout=null,a.setTrackListDetail()},1e3)):a.setTrackListDetail()},setTrackListDetail:function(){var a=this,b=JSON.parse(localStorage.haitao_trackList||"{}")||{};if(haitaoRuntime&&"background"==haitaoRuntime){for(var c=a.trackListObj.trackList,d=0;d<c.length;d++){var e=c[d];for(var f in b)for(var g=0;g<b[f].trackList.length;g++)if(b[f].trackList[g].shipNum==e.shipNum){b[f].trackList[g]=e;break}}localStorage.haitao_trackList=JSON.stringify(b)}else{var h=a.getAccountId();null!=h&&(b[h]=a.trackListObj,localStorage.haitao_trackList=JSON.stringify(b))}a.setBadgeText(),a.sendTransTimeStat()},getDateFormatYYYYMMDD:function(a){var b=new Date(1e3*a),c=b.getMonth()+1;return b.getFullYear()+"-"+c+"-"+b.getDate()},sendTransTimeStat:function(){var a=this,b=JSON.parse(localStorage.haitao_trackList||"{}")||{};for(var c in b)for(var d=0;d<b[c].trackList.length;d++){var e=b[c].trackList[d];if(!e.hasSendStat&&e.t1&&e.t2&&e.t3&&e.t4){e.hasSendStat=1;var f={comp:e.transComp,order:e.shipNum,t1:a.getDateFormatYYYYMMDD(e.t1),t2:a.getDateFormatYYYYMMDD(e.t2),t3:a.getDateFormatYYYYMMDD(e.t3),t4:a.getDateFormatYYYYMMDD(e.t4)};KISSY.io.get("http://haiwai.etao.com/ajax/shenqi_time_gather.htm",f)}}localStorage.haitao_trackList=JSON.stringify(b)},setBadgeText:function(){for(var a=this,b=0,c=a.trackListObj.trackList,d=0;d<c.length;d++){var e=c[d];""!=e.shipStatusRemind&&b++}haitao_tools.setPopupBadgeText(b)},getShipStatusShort:function(a,b){var c=b||16;return a>c?a.substring(0,c-2)+"...":a},getAccountId:function(){var a=JSON.parse(localStorage.haitao_login||null);return a&&"true"==a.login?a.unb:null},delFromTrackList:function(a){var b=this,c=getAccountId();if(null!=c)for(var d=0;d<b.trackListObj.trackList.length;d++)if(b.trackListObj.trackList[d].shipNum==a){b.trackListObj.trackList.splice(d,1),b.setTrackList(),KISSY.one(".haitao_shipList")?KISSY.one(".haitao_shipList").fire("trackChange"):"";break}},addToTrackList:function(a,b){for(var c=this,d=!1,e=0;e<c.trackListObj.trackList.length;e++)if(c.trackListObj.trackList[e].shipNum==a.shipNum){d=!0,b&&(c.trackListObj.trackList[e]=a);break}d||c.trackListObj.trackList.push(a),c.setTrackList(),KISSY.one(".haitao_shipList")?KISSY.one(".haitao_shipList").fire("trackChange"):""},getShipStatus:function(a){var b=this,c=!1,d=localStorage.haitao_lastestTrackTime;if(a||!d)c=!0;else{var e=new Date,f=e.getTime()-parseFloat(d),g=1e3*parseInt(localStorage.haitao_trackInterval||1)*60*60;f>=g&&(c=!0)}if(c){localStorage.haitao_lastestTrackTime=(new Date).getTime();var h=b.getTrackList();if(h&&h.trackList&&h.trackList.length>0)for(var i=0;i<h.trackList.length;i++){var j=h.trackList[i];"1"!=j.shipStatus?b.getShipStatusAjax(j,function(){b.getTransferNumAjax()}):b.getTransferNumAjax()}}},getTransferNumAjaxTimeout:null,getTransferNumAjax:function(){var a=this;a.getTransferNumAjaxTimeout&&clearTimeout(a.getTransferNumAjaxTimeout),a.getTransferNumAjaxTimeout=setTimeout(function(){function b(b,c){function d(b){var d=a.getAccountId();if(null!=d){var e="object"==typeof b?b:JSON.parse(b),f=e?e[c.listName]:[];if(f&&f.length>0)for(var g=0;g<f.length;g++)for(var h=f[g],i=0;i<a.trackListObj.trackList.length;i++){var j=a.trackListObj.trackList[i];if(j.shipNum==h[c.shipNumber]){j.transCompStatus=h[c.status].toString(),j.shipStatusRemind="";var k=h[c.status].toString();if(""!=h[c.inlandNumber].trim()&&(j.transShipNum=h[c.inlandNumber],j.transShipComp=a.matchTransShipComp(h[c.inlandCompany]||c.inlandCompanyDef),""!=j.transShipNum&&(j.transShipNumTrue="true"),k==c.shipFromTransfer)){var l=h[c.shipMessage];j.transShipStatusText=l,j.transShipStatusShort=a.getShipStatusShort(l),l.indexOf("收寄")>=0&&l.indexOf("广州")>=0&&(j.shipStatusRemind="clear")}k==c.forecast?j.shipStatusRemind="forecast":k==c.delivery?j.shipStatusRemind="delivery":k==c.shipFromTransfer&&(j.shipStatusRemind="",j.transShipStatusShort="已签收",j.transShipStatusText="已签收");break}}a.setTrackList(),a.getTransferStatus()}}KISSY.io.get(c.url.replace("$$queryString$$",b.join(c.joinString)),function(a){d(a)})}a.getTransferNumAjaxTimeout=null;var c={},d=a.getTrackList();if(d&&d.trackList&&d.trackList.length>0)for(var e=0;e<d.trackList.length;e++){var f=d.trackList[e];"other"!=f.transComp&&"true"!=f.transShipNumTrue&&(c[f.transComp]||(c[f.transComp]=[]),c[f.transComp].push(f.shipNum))}var g={youjia:{id:"youjia",url:'http://api.youjiaus.net/app/transit/resource/transit?format=json&requestdata={"UserName":"wwwetaocom","Token":"c37145e329405ee0cb48fb07e9d075d6","TrackType":1,"TrackingList":["$$queryString$$"]}',listName:"TrackingList",status:"Status",shipNumber:"TrackingNumber",inlandNumber:"PackageNumber",inlandCompany:"PackageCompany",inlandCompanyDef:"ems",forecast:"0",delivery:"2",shipFromTransfer:"notSupport",shipMessage:"Message",joinString:'","'},banma:{id:"banma",url:'http://api.360banma.com/etao/get_trans_info?format=json&requestdata={%22Token%22:%221c0d7db2b7ed8ed8%22,%22TrackType%22:1,%22UserName%22:%22etao_zebra_2013%22,%22TrackingList%22:["$$queryString$$"]}',listName:"TrackingList",status:"Status",shipNumber:"TrackingNumber",inlandNumber:"PackageNumber",inlandCompany:"TransCompany",inlandCompanyDef:"ems",forecast:"a",delivery:"c",shipFromTransfer:"f",shipMessage:"Message",joinString:'","'},disifang:{id:"disifang",url:"http://tr.4px.com/transport/TransportStatusSearch.aspx?key=KOXIALEU&code=$$queryString$$",listName:"results",status:"status",shipNumber:"request",inlandNumber:"tracking_no_in_china",inlandCompany:"logistics_company",inlandCompanyDef:"ems",forecast:"NO_RECORD",delivery:"NEED_USER_HANDLE",shipFromTransfer:"notSupport",shipMessage:"notSupport",joinString:","},baitong:{id:"baitong",url:"http://api.buytong.com/SearchTransportStatus/?key=HAIWAIETAO&code=$$queryString$$",listName:"results",status:"status",shipNumber:"request",inlandNumber:"tracking_no_in_china",inlandCompany:"logistics_company",inlandCompanyDef:"ems",forecast:"NO_RECORD",delivery:"NEED_USER_HANDLE",shipFromTransfer:"notSupport",shipMessage:"notSupport",joinString:","}};for(var h in c){console.log("-------comp",h);var i=c[h],j=g[h];b(i,j)}},1e3)},getTransferStatus:function(){var a=this,b=a.trackListObj;if(b&&b.trackList&&b.trackList.length>0)for(var c=0;c<b.trackList.length;c++){var d=b.trackList[c];if("true"==d.transShipNumTrue&&"other"!=d.transComp){if("banma"==d.transComp)continue;a.getTransferStatusAjax(d),KISSY.one(".haitao_shipList")?KISSY.one(".haitao_shipList").fire("trackChange"):""}}else KISSY.one(".haitao_shipList")?KISSY.one(".haitao_shipList").fire("trackChange"):""},getTransferStatusAjax:function(a){function b(b){var d="object"==typeof b?b:JSON.parse(b);if(0==d.code){if(1==d.status)a.transShipStatusShort="已签收",a.transShipStatusText="已签收",a.shipStatusRemind="",a.t3=d.progress[0].time,a.t4=d.progress[d.progress.length-1].time;else{var e=d.progress;if(e&&e.length>0){var f=decodeURI(e[e.length-1].text);a.transShipStatusText=f,a.transShipStatusShort=c.getShipStatusShort(f),f.indexOf("收寄")>=0&&f.indexOf("广州")>=0&&(a.shipStatusRemind="clear")}}c.addToTrackList(a,!0)}}console.log("itemObjAfterMatch-",a.transShipComp,":",a.transShipNum);var c=this,d="http://api1.hai0.com/kd.php?key=G00TBPg9aKAAjXZtfFeA&id="+a.transShipComp+"&num="+a.transShipNum;KISSY.io.get(d,function(a,c){"success"==c&&b(a)})},matchTransShipComp:function(a){a=a.toLocaleLowerCase();var b="null";return a.match("韵达")?b="yunda":a.match("申通")?b="stsd":a.match("圆通")||a.match("YT")?b="ytsd":a.match("顺丰")?b="sf":a.match("速尔")?b="suer":a.match("ems")?b="ems":a.match("fedex")?b="fedex":a.match("dhl")?b="dhl":a.match("ups")?b="ups":a.match("usps")&&(b="usps"),b},getShipStatusAjax:function(a,b){var c=this,d="http://api1.hai0.com/kd.php?key=G00TBPg9aKAAjXZtfFeA&id="+a.shipComp+"&num="+a.shipNum;KISSY.io.get(d,function(d,e){if("success"==e){var f="object"==typeof d?d:JSON.parse(d);if(0==f.code){if(a.shipStatus=f.status,1==f.status)a.shipStatusText="已签收",a.t1=f.progress[0].time,a.t2=f.progress[f.progress.length-1].time;else{var g=f.progress;g.length>0&&(a.shipStatusText=decodeURI(g[g.length-1].text))}var h=16;a.shipStatusShort=a.shipStatusText.length>h?a.shipStatusText.substring(0,h-2)+"...":a.shipStatusText,c.addToTrackList(a,!0)}}b()})}}),b}),KISSY.add("haitaoPopup",function(a,b,c,d,e,f){function g(a,b){return a.time>b.time?-1:a.time<b.time?1:void 0}function h(){var a=KISSY.one(".haitao_shipList"),b=getAccountId();if(null!=b&&a){var c=v.getTrackList();if(c&&c.trackList&&c.trackList.length>0){c.trackList.sort(g);for(var d=0;d<c.trackList.length;d++)c.trackList[d].orderNum=d+1,"haitaoke"==c.trackList[d].transComp&&(c.trackList[d].transShipComp="haitaoke",c.trackList[d].transShipNumTrue="true");var f=e.to_html(window.Ali_Haitao.template.trackTable,KISSY.merge(c,{}));return a.html(f),a.parent().addClass("haitao_hasShip"),void(c.trackList.length>=10?KISSY.one(".haitao_addShip").removeClass("haitao_unfold").addClass("haitao_overlimit"):KISSY.one(".haitao_addShip").removeClass("haitao_overlimit"))}}a.html(""),a.parent().removeClass("haitao_hasShip")}function i(){var a=KISSY.one("#haitao_del_confirm");a&&a.remove()}function j(){var a=new b.Tabs("#haitao_pop_tab",{triggerType:"click",switchTo:0});a.on("beforeSwitch",function(a){if(1==a.toIndex){var b=JSON.parse(localStorage.haitao_login||null);if(!b||"true"!=b.login)return window.haitaoLogin.login(),!1}}),a.on("switch",function(a){var b=a.currentIndex;KISSY.one("body").width(800),1==b&&(v.getShipStatus(!0),KISSY.one(".haitao_shipList")?KISSY.one(".haitao_shipList").fire("trackChange"):"",localStorage.hasShowAddrNotify=!0,haitao_tools.setPopupBadgeText(0))}),KISSY.one("#haitao_pop_tab").on("logout",function(){a.switchTo(0)}),a.switchTo(0),chrome.browserAction.getBadgeText({},function(b){""!=b.trim()&&a.switchTo(1)})}function k(a,b,c){var d=a.offset(),e=a.width(),f=a.height();return{left:d.left+(b?b:0),top:d.top+(c?c:0),right:d.left+e+(b?b:0),bottom:d.top+f+(c?c:0)}}function l(a){a.id="haitao_reminder_tip";var b=KISSY.one("#"+a.id);b&&b.remove();var c=KISSY.one(a.query);if(c){var d=c;if(d){var f=k(d,8,-8),g=e.to_html(u,{left:f.right,top:f.top,id:a.id,text:a.text,tagName:a.tagName||"div",linkAddr:a.linkAddr||"",datastat:a.datastat||""});KISSY.one("body").append(g)}}}function m(a,b){var c=/[^x00-xff]/gi,d=a.match(c)?a.match(c).length:0,e=a.length+d;return e>b?m(a.substring(0,a.length-1),b):a}function n(){KISSY.one(".haitao_addBtn").on("click",function(){KISSY.one(".haitao_addShip").hasClass("haitao_overlimit")||KISSY.one(".haitao_addShip").addClass("haitao_unfold")}),KISSY.one(".haitao_ns_add").on("click",function(){KISSY.one(".haitao_addShip").addClass("haitao_unfold")}),KISSY.one(".haitao_addCloseBtn").on("click",function(){KISSY.one(".haitao_addShip").removeClass("haitao_unfold")}),KISSY.one("#haitao_ship_input").on("keyup",function(){var a=KISSY.one("#haitao_ship_input"),b=/[^a-zA-Z0-9]/g,c=parseInt(a.attr("limitlength")||1e5);a.val(a.val().replace(b,"").substring(0,c))}),KISSY.one("#haitao_remark_input").on("keyup",function(){var a=KISSY.one("#haitao_remark_input"),b=parseInt(a.attr("limitlength")||1e5),c=m(a.val(),b);a.val()!=c&&a.val(c)}),KISSY.one("#haitao_addConfirmBtn").on("click",function(){var a=r.get("value"),b=s.get("value"),c=KISSY.one("#haitao_ship_input").val(),d=KISSY.one("#haitao_remark_input").val(),e=new Date;if("null"==a)return void KISSY.one(".haitao_ship_sel").addClass("focus_boder");if(""==c)return void KISSY.DOM.get("#haitao_ship_input").focus();if("null"==b)return void KISSY.one(".haitao_trans_sel").addClass("focus_boder");var f=/[^a-zA-Z0-9]/g;if(!f.test(c.trim())){KISSY.one("#haitao_ship_input").val(""),KISSY.one("#haitao_remark_input").val("");{v.addToTrackList({orderNum:1,time:e.getTime(),trackRemark:d,shipComp:a,shipNum:c,shipStatus:"",shipStatusText:"",shipStatusShort:"",transComp:b,transCompStatus:"",transShipNum:"尚未出单号",transShipComp:"尚未出单号",transShipNumTrue:"false",transShipStatus:"",transShipStatusText:"",transShipStatusShort:"",shipStatusRemind:""})}v.getShipStatus(!0),KISSY.one(".haitao_shipList")?KISSY.one(".haitao_shipList").fire("trackChange"):"",KISSY.one(".haitao_addCloseBtn").fire("click")}}),KISSY.Event.delegate("#haitao_pop_tab","click",".haitao_del",function(a){i();var b=KISSY.DOM.parent(a.target,"tr"),c=b.getAttribute("shipNum"),d=KISSY.one(a.target).offset(),f=e.to_html(t,{shipNum:c,top:d.top-22,right:KISSY.one(document).width()-d.left+10});KISSY.one("body").append(f)});var a=null;KISSY.Event.delegate("#haitao_pop_tab","mouseout",".oper_reminder",function(){a&&(clearTimeout(a),a=null),a=setTimeout(function(){var b=KISSY.one("#haitao_reminder_tip");b&&b.remove(),a=null},5e3)}),KISSY.Event.delegate("#haitao_pop_tab","mouseenter",".oper_reminder",function(a){var b=getAccountId();if(null!=b){var c=localStorage["login_alipay_id_"+b];if(!c)return console.log("getAlipayIdAjax 点击reminder的时候发现没有alipayid，即登陆情况下还没有获取到alipayid"),void getAlipayIdAjax();var d=KISSY.one(a.target),e=JSON.parse(localStorage.haitao_map_transComp||"{}"),f=e[d.attr("transcomp")],g="https://auth.alipay.com/login/trustLoginResultDispatch.htm?sign_from=3000&goto=https%3A%2F%2Fopenauth.alipay.com%2Foauth2%2Fauthorize.htm%3Fclient_id%3D2013013100000065%26state%3Detao_jump_gtsp%2C"+f+"%2C"+c+"%2C";if(d&&d.hasClass("oper_reminder_forecast")){if(!f)return void console.log("get transfer company alipay id error!");l({query:a.target,text:"包裹已发出，去预报",datastat:"icon.ship.infor1",tagName:"a",linkAddr:g+"1"})}else if(d&&d.hasClass("oper_reminder_delivery")){if(!f)return void console.log("get transfer company alipay id error!");l({query:a.target,text:"包裹已入库，去处理",datastat:"icon.ship.infor2",tagName:"a",linkAddr:g+"2"})}else d&&d.hasClass("oper_reminder_clear")&&l({query:a.target,tagName:"div",text:"包裹完成清关，请注意查收",linkAddr:""})}}),KISSY.one("body").on("click",function(b){var c=KISSY.one(b.target),d=KISSY.DOM.parent(b.target,"#oper_reminder");if(!d&&!c.hasClass("oper_reminder")){var e=KISSY.one("#haitao_reminder_tip");e&&e.remove(),clearTimeout(a),a=null}}),KISSY.Event.delegate("body","click",".haitao_btn_confirm",function(a){var b=a.target.getAttribute("shipNum");v.delFromTrackList(b),i()}),KISSY.Event.delegate("body","click",".haitao_btn_cancel",function(){i()}),KISSY.one("body").on("click",function(a){var b=KISSY.one(a.target);b&&"haitao_addConfirmBtn"!=b.attr("id")&&(KISSY.one(".haitao_ship_sel").removeClass("focus_boder"),KISSY.one(".haitao_trans_sel").removeClass("focus_boder"));var c=KISSY.DOM.parent(a.target,"#haitao_del_confirm");c||b.hasClass("haitao_del")||i()});var b=null;KISSY.one(".haitao_shipList").on("trackChange",function(){null==b&&(b=setTimeout(function(){b=null,h()},10))})}function o(){var a=localStorage.haitao_trackInterval||"1";KISSY.one("#haitao_queryInterval_sel")[0].value=a,q=c.Select.decorate("#haitao_queryInterval_sel",w),q.on("click",function(){localStorage.haitao_trackInterval=q.get("value")}),w.elCls="haitao_ship_sel",r=c.Select.decorate("#haitao_ship_sel",w),w.elCls="haitao_trans_sel",s=c.Select.decorate("#haitao_trans_sel",w)}function p(){j(),n(),o()}var q,r,s,t='<div id="haitao_del_confirm" style="right:{{right}}px;top:{{top}}px;" class="haitao-clearfix"><div class="haitao_btn_cancel haitao-stat" data-stat="icon.ship.del_cancel">取消</div><div class="haitao_btn_confirm haitao-stat" data-stat="icon.ship.del_confirm" shipNum="{{shipNum}}">确定</div><div class="haitao_del_text">亲，确定删除这条运单吗？</div></div>',u='<div id="{{id}}" class="haitao_font haitao_tips haitao_tips_option haitao_triangle left" style="left:{{left}}px; top:{{top}}px;"><{{tagName}} target="_blank" href="{{linkAddr}}" data-stat="{{datastat}}" class="haitao_tips_title shiplink haitao-stat"><span class="haitao_tips_center">{{text}}</span><i></i></{{tagName}}></div>',v=new f;v.getTrackList();var w={width:125,prefixCls:"haitao-",menuAlign:{offset:[0,2]},menuCfg:{width:125,align:{offset:[0,-1]},elStyle:{overflow:"auto",overflowX:"hidden"}}};return p},{requires:["switchable","menubutton","button","mu","haitaoTrackAjax"]}),KISSY.add("haitaoFeed",function(a,b){function c(){}return c},{requires:["mu"]}),window.Ali_Haitao={};var haitao_tools={setPopupBadgeText:function(a){isNaN(a)&&(a=0),localStorage.hasShowAddrNotify="true";var b=localStorage.hasShowAddrNotify;b&&"true"==b||a++,a>0?(KISSY.one("#haitao_pop_tab")?KISSY.one("#haitao_pop_tab").addClass("showBadge"):"",chrome.browserAction.setBadgeBackgroundColor({color:"#ff3c00"}),chrome.browserAction.setBadgeText({text:a.toString()})):(KISSY.one("#haitao_pop_tab")?KISSY.one("#haitao_pop_tab").removeClass("showBadge"):"",chrome.browserAction.setBadgeText({text:""}))}},getAlipayTimeout=null;KISSY.add("haitaoZhuanXiang",function(S,Node,Base,IO,Mustache,Pagination){function HaitaoZhuanXiang(a){HaitaoZhuanXiang.superclass.constructor.call(this,a),this.init()}return S.extend(HaitaoZhuanXiang,Base,{init:function(){var a=this;a._initHtml()},_formatData:function(data){var me=this,items=eval(data),gap=me.get("gap");return S.each(items,function(a,b){b%gap==gap-1&&(a.isLast=!0),a.code&&""!=a.code&&(a.hasCode=!0)}),items},_initHtml:function(){var a=this,b=a.get("el"),c="",d=a.get("url");IO.get(d,function(d){var d=a._formatData(d),e=a.get("gap"),f=null;0!=d.length&&(a.get("tab")&&a.get("tab").show(),c=Mustache.to_html(window.Ali_Haitao.template.zhuanxiang,KISSY.merge({items:d.slice(0,2)},{})),b.one(".content").html(c),a.set("data",d),Math.ceil(d.length/e)>1&&(f=new Pagination("J_pagination",{currentPage:1,totalPage:Math.ceil(d.length/e),preposePagesCount:1,postposePagesCount:1,lastPagesCount:1}),a.set("pagination",f)),a._bindEvents())})},_clipboardWrite:function(a){try{var b=document.createElement("div");S.one(b).css({position:"fixed"}),b.contentEditable=!0,document.body.appendChild(b),b.innerHTML=a,b.unselectable="off",b.focus(),document.execCommand("SelectAll"),document.execCommand("Copy",!1,null),document.body.removeChild(b)}catch(c){}},_bindEvents:function(){var a=this,b=a.get("el");b.delegate("click",".btn.copy",function(b){b.preventDefault();var c=S.one(b.target),d=c.siblings(".code").text();"qixiu.etao.com"!=location.host&&a._clipboardWrite(d)}),a.get("pagination")&&a.get("pagination").on("switch",function(c){var d=c.toPage,e=a.get("gap"),f=a.get("data").slice(e*(d-1),e*d);html=Mustache.to_html(window.Ali_Haitao.template.zhuanxiang,KISSY.merge({items:f},{})),b.one(".content").html(html)})}},{ATTRS:{el:{value:null},pagination:{value:null},data:{value:null},gap:{value:2},url:{value:"http://www.etao.com/go/rgn/haitaoshenqi-shenqizhuanxiang.php"},tab:{value:null}}}),HaitaoZhuanXiang},{requires:["node","base","ajax","mu","pagination"]}),KISSY.ready(function(){AliStatistics(),window.Ali_Haitao.config=JSON.parse(localStorage.haitao_config||null),window.Ali_Haitao.mmstat_cna=localStorage.haitao_mmstat_cna||"null",window.Ali_Haitao.isLoadRemoteRes=localStorage.isLoadRemoteRes&&"true"==localStorage.isLoadRemoteRes?!0:!1,window.Ali_Haitao.template=getTemplate(),popup_init()});